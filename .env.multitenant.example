# DBPower AI Cloud - Multi-Tenant Configuration
# Copy this file to .env and adjust values

# ========================================
# DATABASE CONFIGURATION (Multi-Tenant)
# ========================================
# Database type: "postgresql" (production) or "sqlite" (development)
DB_TYPE=postgresql

# PostgreSQL Configuration (Production/SaaS)
DB_HOST=localhost
DB_PORT=5432
DB_NAME=dbpower_cloud
DB_USER=dbpower_user
DB_PASSWORD=your_secure_password_here

# Alternative: Use full DATABASE_URL (overrides above)
# DATABASE_URL=postgresql://user:password@host:port/database

# Connection Pool Settings
DB_POOL_SIZE=10
DB_MAX_OVERFLOW=20
SQL_ECHO=false  # Set to true for SQL query debugging

# SQLite Configuration (Development only)
# DB_PATH=/app/cache/dbpower_multitenant.db

# ========================================
# AUTHENTICATION & SECURITY
# ========================================
# JWT Secret (MUST CHANGE IN PRODUCTION!)
JWT_SECRET_KEY=your-super-secret-jwt-key-change-this-in-production-min-32-chars
JWT_ALGORITHM=HS256
JWT_ACCESS_TOKEN_EXPIRE_MINUTES=60
JWT_REFRESH_TOKEN_EXPIRE_DAYS=7

# API Key Salt (for hashing organization API keys)
API_KEY_SALT=your-api-key-salt-change-this-min-32-chars

# Super Admin Initial Setup
SUPER_ADMIN_EMAIL=admin@dbpower.local
SUPER_ADMIN_PASSWORD=admin123
SUPER_ADMIN_NAME=Super Administrator

# Create demo organization on init
CREATE_DEMO_ORG=true

# ========================================
# DATA RESIDENCY & COMPLIANCE
# ========================================
# Data region (for future multi-region support)
DATA_REGION=EU  # Options: EU, US, ASIA

# Audit log retention (days)
AUDIT_RETENTION_DAYS=730  # 2 years

# ========================================
# RATE LIMITING
# ========================================
RATE_LIMIT_PER_ORG=1000  # requests per hour per organization
RATE_LIMIT_AI_CALLS=100  # AI analysis calls per hour

# ========================================
# AI ANALYZER CONFIGURATION
# ========================================
# AI Analyzer URL (if running as separate service)
AI_ANALYZER_URL=http://ai-analyzer:8001

# AI Provider Selection (used by AI Analyzer service)
AI_PROVIDER=llama  # Options: llama, openai, anthropic

# AI General Settings
AI_LOG_REQUESTS=true
AI_TIMEOUT=120.0
AI_MAX_RETRIES=3

# ----------------------------------------
# LLaMA/Ollama Configuration (LOCAL - 100% Private)
# ----------------------------------------
LLAMA_BASE_URL=http://ai-llama:11434
LLAMA_MODEL=llama3.1:8b

# ----------------------------------------
# OpenAI Configuration (CLOUD - ⚠️ Data sent externally)
# ----------------------------------------
# OPENAI_API_KEY=sk-proj-...
# OPENAI_MODEL=gpt-4-turbo-preview
# OPENAI_BASE_URL=https://api.openai.com/v1
# OPENAI_MAX_TOKENS=2000

# ----------------------------------------
# Anthropic Configuration (CLOUD - ⚠️ Data sent externally)
# ----------------------------------------
# ANTHROPIC_API_KEY=sk-ant-...
# ANTHROPIC_MODEL=claude-3-sonnet-20240229
# ANTHROPIC_BASE_URL=https://api.anthropic.com/v1
# ANTHROPIC_MAX_TOKENS=2000

# ========================================
# MYSQL DATABASE TO MONITOR (Legacy/Testing)
# ========================================
# These settings are used for direct monitoring (legacy mode)
# In production, client agents connect to customer databases
MYSQL_HOST=127.0.0.1
MYSQL_PORT=3306
MYSQL_USER=root
MYSQL_PASSWORD=root
MYSQL_DB=labdb

# DBPower Monitoring User (used for EXPLAIN queries)
DBPOWER_USER=dbpower_monitor
DBPOWER_PASSWORD=your_monitoring_password_here

# ========================================
# APPLICATION SETTINGS
# ========================================
LOG_LEVEL=INFO
COLLECTION_INTERVAL=60  # seconds (legacy direct collection)
API_PORT=8000

# CORS Settings (restrict in production!)
CORS_ORIGINS=http://localhost:3000,http://localhost:8000
# For production: CORS_ORIGINS=https://your-domain.com

# ========================================
# CLIENT AGENT CONFIGURATION
# ========================================
# These settings are used by client agents (deployed at customer sites)
# CLIENT_AGENT_ID=unique-agent-id
# SAAS_API_URL=https://your-saas.com/api/v1
# SAAS_API_KEY=dbp_123_your-org-api-key
# ANONYMIZATION_LEVEL=strict  # Options: strict, moderate, minimal

# ========================================
# PRIVACY & COMPLIANCE NOTES
# ========================================
# Multi-Tenant Architecture:
# - Each organization is completely isolated
# - Data is encrypted in transit (TLS 1.3)
# - API keys are hashed with SHA-256
# - All actions are audit logged
#
# AI Processing:
# - LLaMA:     100% local processing, no external API calls
# - OpenAI:    Anonymized queries sent to https://api.openai.com
# - Anthropic: Anonymized queries sent to https://api.anthropic.com
#
# Client Agent:
# - Connects to customer databases (on-premise)
# - Anonymizes sensitive data before transmission
# - Uses TLS 1.3 + API key authentication
# - All queries are fingerprinted (no raw data stored)
#
# Compliance:
# - Audit logs retained for 2 years (configurable)
# - Data residency support (future: multi-region)
# - GDPR-compliant data handling
# - Ready for SOC2/ISO27001 audits
